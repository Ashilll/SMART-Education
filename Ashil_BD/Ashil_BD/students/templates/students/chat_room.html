{% extends 'students/base.html' %}
{% block title %}üí¨ –ß–∞—Ç{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0">üí¨ –ß–∞—Ç –∫–æ–º–Ω–∞—Ç—ã: <strong>{{ room_name }}</strong></h4>
                </div>
                
                <!-- –û–î–ò–ù –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π -->
                <div class="card-body p-0">
                    <div id="chat-container" style="height: 400px; overflow-y: auto; padding: 15px; background: #f8f9fa;">
                        {% for message in messages %}
                        <div class="mb-3">
                            <div class="d-flex {% if message.user.username == 'guest' %}justify-content-start{% else %}justify-content-end{% endif %}">
                                <div class="p-2 rounded {% if message.user.username == 'guest' %}bg-white border{% else %}bg-primary text-white{% endif %}" style="max-width: 70%;">
                                    <small class="fw-bold">{{ message.user.username }}</small><br>
                                    {{ message.message }}
                                    <div class="small {% if message.user.username == 'guest' %}text-muted{% else %}text-light{% endif %}">
                                        {{ message.timestamp|date:"H:i" }}
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% empty %}
                        <div class="text-center text-muted py-5">
                            <div class="fs-1">üí¨</div>
                            <p>–ü–æ–∫–∞ –Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="card-footer">
                    <form method="post">
                        {% csrf_token %}
                        <div class="input-group">
                            <input type="text" name="message" class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." required>
                            <button type="submit" class="btn btn-success">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- –ö–æ–º–Ω–∞—Ç—ã —á–∞—Ç–∞ -->
            <div class="mt-3 text-center">
                <h6>–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–æ–º–Ω–∞—Ç—É:</h6>
                <div class="btn-group">
                    <a href="{% url 'chat_room' 'general' %}" class="btn btn-outline-primary btn-sm">üë• –û–±—â–∏–π</a>
                    <a href="{% url 'chat_room' 'python' %}" class="btn btn-outline-success btn-sm">üêç Python</a>
                    <a href="{% url 'chat_room' 'web' %}" class="btn btn-outline-info btn-sm">üåê Web</a>
                    <a href="{% url 'chat_room' 'questions' %}" class="btn btn-outline-warning btn-sm">‚ùì –í–æ–ø—Ä–æ—Å—ã</a>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// –ê–≤—Ç–æ-—Å–∫—Ä–æ–ª–ª –≤–Ω–∏–∑
document.addEventListener('DOMContentLoaded', function() {
    const chatContainer = document.getElementById('chat-container');
    chatContainer.scrollTop = chatContainer.scrollHeight;
});
</script>
{% endblock %}